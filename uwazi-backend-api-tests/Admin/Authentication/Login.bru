meta {
  name: Login
  type: http
  seq: 2
}

post {
  url: {{local_url}}/login
  body: multipartForm
  auth: none
}

body:json {
  {
    "username": "dev@codeanza.com",
    "password": "Dev@2030"
  }
}

body:multipart-form {
  username: mwas@gmail.com
  password: Admin@123
}

tests {
  test("should be able to login", function () {
    const data = res.getBody();
    console.log('Login response:', data);
    expect(res.getStatus()).to.equal(200);
    
    // Set environment variable from response data
    if (data && data.access_token) {
      bru.setEnvVar('auth_token', data.access_token);
      console.log("Auth token saved to environment");
    } else {
      console.error("No access_token found in response");
    }
  });
  
  test("should return correct structure", function () {
    const data = res.getBody();
    expect(data).to.have.property("access_token");
    expect(data).to.have.property("token_type");
    expect(data.token_type).to.equal("bearer");
  });
}
